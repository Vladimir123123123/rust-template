using UnityEngine;

public class BeeGrenade : TimedExplosive
{
	public GameObjectRef beeSwarmPrefab;

	public override void Explode()
	{
		if (beeSwarmPrefab.isValid && !WaterLevel.Test(base.transform.position, waves: true, volumes: true, this))
		{
			Vector3 position = base.transform.position;
			if (creatorPlayer != null)
			{
				Vector3 normalized = (creatorPlayer.transform.position - base.transform.position).normalized;
				position += normalized * 1f;
			}
			if (!GamePhysics.Trace(new Ray(CenterPoint(), Vector3.up), 0f, out var _, 2f, -928830719, QueryTriggerInteraction.Ignore, this))
			{
				position += Vector3.up * 1.5f;
			}
			GameManager.server.CreateEntity(beeSwarmPrefab.resourcePath, position, Quaternion.identity).Spawn();
		}
		base.Explode();
	}

	public void DelayedDestroy()
	{
		Kill(DestroyMode.Gib);
	}
}
