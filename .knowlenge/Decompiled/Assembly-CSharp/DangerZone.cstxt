using UnityEngine;

public class DangerZone
{
	public float Radius;

	private float score;

	private float lastActiveTime = Time.realtimeSinceStartup;

	private const float isStaleTime = 5f;

	private Vector3 centre;

	private BaseEntity parent;

	public Vector3 Centre
	{
		get
		{
			if (parent == null)
			{
				return centre;
			}
			return parent.transform.TransformPoint(centre);
		}
	}

	public float Score
	{
		get
		{
			return score;
		}
		set
		{
			score = value;
			lastActiveTime = Time.realtimeSinceStartup;
		}
	}

	public float LastActiveTime => lastActiveTime;

	public DangerZone(Vector3 centre, float radius = 20f, BaseEntity parent = null)
	{
		if (parent == null)
		{
			this.centre = centre;
		}
		else
		{
			this.centre = parent.transform.InverseTransformPoint(centre);
		}
		this.parent = parent;
		Radius = radius;
	}

	public bool IsPointInside(Vector3 point)
	{
		return Vector3.Distance(point, Centre) <= Radius;
	}

	public bool IsStale()
	{
		return Time.realtimeSinceStartup - lastActiveTime > 5f;
	}

	public Vector3 GetNearestEdge(Vector3 point)
	{
		Vector3 normalized = (point - Centre).normalized;
		normalized.y = 0f;
		return Centre + normalized * Radius;
	}
}
