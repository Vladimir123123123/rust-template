using System;
using System.Collections.Generic;
using UnityEngine;

[Serializable]
public class FoodVisualConfig
{
	public List<FoodVisualObject> VisualItems = new List<FoodVisualObject>();

	public string TintMaterialProperty;

	private MaterialPropertyBlock materialPB;

	private int detailAlbedo;

	public void InitForItem(Item item)
	{
		if (item != null && !(item.info == null))
		{
			InitForItemDef(item.info);
		}
	}

	public void InitForItemDef(ItemDefinition itemDef)
	{
		if (itemDef == null)
		{
			return;
		}
		if (materialPB == null)
		{
			materialPB = new MaterialPropertyBlock();
			detailAlbedo = Shader.PropertyToID(TintMaterialProperty);
		}
		FoodVisualObject foodVisualObject = null;
		foreach (FoodVisualObject visualItem in VisualItems)
		{
			if (visualItem != null)
			{
				visualItem.SetVisible(flag: false);
				if (visualItem.ItemDef == itemDef)
				{
					foodVisualObject = visualItem;
				}
			}
		}
		if (foodVisualObject != null)
		{
			foodVisualObject.SetVisible(flag: true);
			foodVisualObject.ApplyTint(materialPB, detailAlbedo);
		}
	}

	public void HideAll()
	{
		foreach (FoodVisualObject visualItem in VisualItems)
		{
			visualItem?.SetVisible(flag: false);
		}
	}
}
