using System;
using Oxide.Core;

[Serializable]
public class IORef
{
	public EntityRef entityRef;

	public IOEntity ioEnt;

	public void Init()
	{
		if (ioEnt != null && !entityRef.IsValid(serverside: true))
		{
			entityRef.Set(ioEnt);
		}
		if (entityRef.IsValid(serverside: true))
		{
			ioEnt = entityRef.Get(serverside: true).GetComponent<IOEntity>();
		}
	}

	public void InitClient()
	{
		if (entityRef.IsValid(serverside: false) && ioEnt == null)
		{
			ioEnt = entityRef.Get(serverside: false).GetComponent<IOEntity>();
		}
	}

	public IOEntity Get(bool isServer = true)
	{
		if (ioEnt == null && entityRef.IsValid(isServer))
		{
			ioEnt = entityRef.Get(isServer) as IOEntity;
		}
		return ioEnt;
	}

	public void Clear()
	{
		IOEntity obj = ioEnt;
		ioEnt = null;
		entityRef.Set(null);
		Interface.CallHook("OnIORefCleared", this, obj);
	}

	public void Set(IOEntity newIOEnt)
	{
		entityRef.Set(newIOEnt);
	}
}
