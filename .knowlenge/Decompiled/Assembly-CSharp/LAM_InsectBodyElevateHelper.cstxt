using FIMSpace.FProceduralAnimation;
using UnityEngine;

public class LAM_InsectBodyElevateHelper : LegsAnimatorControlModuleBase
{
	private float currentHeightAdjust;

	private float sd_currentHeightAdjust;

	private LegsAnimator.Variable _AdjustPowerV;

	private LegsAnimator.Variable _AdjustingSpeedV;

	public override void OnInit(LegsAnimator.LegsAnimatorCustomModuleHelper helper)
	{
		_AdjustPowerV = helper.RequestVariable("Adjust Power", 1f);
		_AdjustingSpeedV = helper.RequestVariable("Adjusting Speed", 1f);
	}

	public override void OnLateUpdatePreApply(LegsAnimator.LegsAnimatorCustomModuleHelper helper)
	{
		float hips_LastHipsOffset = base.LA.HipsSetup._Hips_LastHipsOffset;
		hips_LastHipsOffset = ((!(hips_LastHipsOffset < 0f)) ? 0f : (0f - hips_LastHipsOffset));
		if (_AdjustingSpeedV.GetFloat() >= 1f)
		{
			currentHeightAdjust = hips_LastHipsOffset;
		}
		else
		{
			currentHeightAdjust = Mathf.SmoothDamp(currentHeightAdjust, hips_LastHipsOffset, ref sd_currentHeightAdjust, Mathf.Lerp(0.16f, 0.005f, _AdjustingSpeedV.GetFloat()));
		}
		base.LA.Hips.position += base.LA.Up * currentHeightAdjust * base.EffectBlend * _AdjustPowerV.GetFloat();
	}
}
