using Oxide.Core;

public class MaxDistance : Conditional
{
	private float maximumDistance;

	public bool CheckParent { get; set; }

	public MaxDistance(float maxDist)
	{
		maximumDistance = maxDist;
	}

	public override string GetArgs()
	{
		return maximumDistance.ToString("0.00f") + (CheckParent ? ", true" : "");
	}

	public static bool Test(uint id, string debugName, BaseEntity ent, BasePlayer player, float maximumDistance, bool checkParent = false)
	{
		if (ent == null || player == null)
		{
			return false;
		}
		object obj = Interface.CallHook("OnEntityDistanceCheck", ent, player, id, debugName, maximumDistance, checkParent);
		if (obj is bool)
		{
			return (bool)obj;
		}
		bool flag = ent.Distance(player.eyes.position) <= maximumDistance;
		if (checkParent && !flag)
		{
			BaseEntity parentEntity = ent.GetParentEntity();
			flag = parentEntity != null && parentEntity.Distance(player.eyes.position) <= maximumDistance;
		}
		return flag;
	}
}
