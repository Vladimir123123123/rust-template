using System.IO;
using System.Text;
using UnityEngine;

public static class Mesh
{
	public static void Export(this Mesh mesh, string filename)
	{
		StringBuilder stringBuilder = new StringBuilder();
		_ = mesh.vertices;
		Vector3[] vertices = mesh.vertices;
		for (int i = 0; i < vertices.Length; i++)
		{
			Vector3 vector = vertices[i];
			stringBuilder.AppendLine($"v {vector.x} {vector.y} {vector.z}");
		}
		Vector2[] uv = mesh.uv;
		for (int i = 0; i < uv.Length; i++)
		{
			Vector2 vector2 = uv[i];
			stringBuilder.AppendLine($"vt {vector2.x} {vector2.y}");
		}
		vertices = mesh.normals;
		for (int i = 0; i < vertices.Length; i++)
		{
			Vector3 vector3 = vertices[i];
			stringBuilder.AppendLine($"vn {vector3.x} {vector3.y} {vector3.z}");
		}
		for (int j = 0; j < mesh.subMeshCount; j++)
		{
			int[] indices = mesh.GetIndices(j);
			for (int k = 0; k < indices.Length; k += 3)
			{
				stringBuilder.AppendLine($"f {indices[k] + 1}/{indices[k] + 1}/{indices[k] + 1} {indices[k + 1] + 1}/{indices[k + 1] + 1}/{indices[k + 1] + 1} {indices[k + 2] + 1}/{indices[k + 2] + 1}/{indices[k + 2] + 1}");
			}
		}
		if (File.Exists(filename))
		{
			File.Delete(filename);
		}
		File.WriteAllText(filename, stringBuilder.ToString());
	}
}
